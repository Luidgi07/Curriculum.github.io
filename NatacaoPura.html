<!DOCTYPE html>
<html lang="pt">
<head>
<meta charset="UTF-8" />
<title>Imagens Coladas com Retângulos e HUD</title>
<style>
/* (coloca aqui TODO o teu CSS de base, que é muito e já tens copiado acima)
   Não mexo em nada do que tinhas, só JUNTO o CSS do flip e conteúdos extra em baixo! ... */

.cartao-dir {
  width:270px;
  background: #101e30;
  display:flex;
  flex-direction:column;
  justify-content: center;
  align-items: stretch;
  gap: 27px;
  padding: 20px 0;
}

/* NOVO: Flip 3D por retângulo da direita */
.retangulo-flip {
  width: 95%;
  margin: 0 auto;
  height: 92px;
  perspective: 700px;
  cursor: pointer;
  position: relative;
  transition: box-shadow 0.2s;
}
.retangulo-flip .face {
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center; justify-content: center;
  font-family: 'Fira Mono', monospace;
  font-size: 1.11em;
  color: #e4f3ff;
  background: #1a2e45;
  border-radius: 10px;
  backface-visibility: hidden;
  position: absolute;
  top: 0; left: 0;
  box-sizing: border-box;
  padding: 0 15px;
  transition: background .15s, color .15s;
}

/* verso comum */
.retangulo-flip .verso {
  background: #368df8;
  color: #18344e;
  flex-direction: column;
  gap: 7px;
  transform: rotateY(180deg);
}

/* frente comum */
.retangulo-flip .frente {
  z-index: 2;
  background: #1a2e45;
}

.retangulo-flip {
  transform-style: preserve-3d;
  transition: transform 0.62s cubic-bezier(.4,1.5,.8,1.1), box-shadow .22s;
}
.retangulo-flip:hover, .retangulo-flip:focus-within {
  transform: rotateY(180deg);
  box-shadow: 0 4px 36px #42aaff55,0 2px 1px #42aaff80;
}

/* Para toque em ecrã tátil: ao tocar roda também */
.retangulo-flip.tocado { transform: rotateY(180deg); }

.retangulo-flip .face {
  position: absolute; width: 100%; height: 100%;
}

/* Estilo específico para Medalhas */
.medalhas-lista {
  display: flex;
  flex-direction: column;
  gap: 7px;
}
.medalha-item {
  display: flex;
  align-items: center;
  gap: 8px;
  margin: 3px 0;
  font-size: 0.93em;
}
.medalha-item img {
  width: 32px; height: 32px;
  border-radius: 50%;
  box-shadow: 0 1px 5px #227aa9cc;
  background: #fff;
}

/* Lesoes só texto */
.texto-lesoes {
  font-size: 1.01em;
  padding: 1.5px 0;
  line-height: 1.22em;
  text-align: left;
}

/* Eventos: só imagens */
.verso .evento-img {
  width: 36px; height: 36px;
  margin: 0 7px 3px 0;
  object-fit: cover;
  border-radius: 7px;
  box-shadow: 0 2px 10px #0044ff55;
  background: #fff;
}
@media (max-width:900px){
  .cartao-dir { gap: 17px; }
  .retangulo-flip { height: 74px;}
  .medalha-item img, .verso .evento-img { width:22px; height:22px;}
}
/* (teu resto do CSS já está aqui em cima) */
</style>
</head>
<body>
<div id="screen-fade"></div>

<div class="top-hud">
  <div class="hud-left">
    <span class="hud-time-date" id="hudTimeDate"></span>
    <button class="left-decor-btn" title="Voltar ao menu inicial" aria-label="Voltar ao menu inicial">
      <svg viewBox="0 0 24 24" fill="none" stroke="#42aaff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true" focusable="false">
        <path d="M3 11.5L12 4l9 7.5"/>
        <path d="M5 10v8a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2v-8"/>
        <path d="M9 22V12h6v10"/>
      </svg>
    </button>
  </div>
  <div class="hud-center">
    <div class="profile-area" title="Meu Perfil" tabindex="0">
      <img src="Áreas (6).png" alt="Meu Perfil" class="profile-img" />
      <span class="profile-name">Luís Correia</span>
    </div>
  </div>
  <div class="hud-right"></div>
</div>
<div class="conteudo-wrapper">
  <div class="sala-imagens" role="list">
    <img src="ab13e542-fc6d-4634-9cd1-8e8dd6b08065.png" alt="imagem 1" role="listitem" tabindex="-1">
    <div class="separador" aria-hidden="true"></div>
    <img src="cmb.png" alt="imagem 2" onclick="abrirCartao(2)" role="listitem" tabindex="0">
    <div class="separador" aria-hidden="true"></div>
    <img src="ANA.png" alt="imagem 3" onclick="abrirCartao(3)" role="listitem" tabindex="0">
    <div class="separador" aria-hidden="true"></div>
    <img src="SFUAP.png" alt="imagem 4" onclick="abrirCartao(4)" role="listitem" tabindex="0">
    <div class="separador" aria-hidden="true"></div>
    <img src="CIRL.png" alt="imagem 5" onclick="abrirCartao(5)" role="listitem" tabindex="0">
    <div class="separador" aria-hidden="true"></div>
    <img src="any.png" alt="imagem 6" onclick="abrirCartao(6)" role="listitem" tabindex="0">
  </div>
</div>

<script>
// --- HUD e imagens ---
function updateHudTime() {
  const el = document.getElementById('hudTimeDate');
  if (!el) return;
  const now = new Date();
  el.textContent = now.toLocaleDateString('pt-PT', { day: '2-digit', month: '2-digit' }) +
  ' ' + now.toLocaleTimeString('pt-PT', { hour: '2-digit', minute: '2-digit' });
}
setInterval(updateHudTime, 1000);
updateHudTime();
document.querySelector('.left-decor-btn').addEventListener('click', () => {
  window.location.href = 'desporto.html';
});
document.querySelectorAll('.sala-imagens img[onclick]').forEach(function(img) {
  let dica;
  img.addEventListener('mouseenter', function(e) {
    dica = document.createElement('div');
    dica.className = 'dica-msg';
    dica.textContent = 'Clica para ver o cartão!';
    const sala = document.querySelector('.sala-imagens');
    const imgRect = img.getBoundingClientRect();
    const salaRect = sala.getBoundingClientRect();
    dica.style.top = (imgRect.top - salaRect.top + 22) + 'px';
    dica.style.left = (imgRect.left - salaRect.left + imgRect.width/2) + 'px';
    sala.appendChild(dica);
  });
  img.addEventListener('mouseleave', function(e) {
    if (dica && dica.parentNode) dica.parentNode.removeChild(dica);
    dica = null;
  });
  img.addEventListener('keydown', function(e) {
    if(e.key === "Enter" || e.key === " ") {
      abrirCartao(parseInt(e.target.getAttribute('onclick')?.match(/\d+/)?.[0]));
    }
  });
});

const pins3 = [
  { top: 28, left: 60, nome: "Piscina A", local: "Lisboa", imagem: "piscinaa.jpg" },
  { top: 47, left: 30, nome: "Piscina B", local: "Porto", imagem: "piscinab.jpg" },
  { top: 63, left: 75, nome: "Piscina C", local: "Faro", imagem: "piscinac.jpg" }
];

const pins4 = [
  { top: 47, left: 50.5, nome: "Piscina D", local: "Madrid - ESP", imagem: "piscinad.jpg" },
  { top: 46, left: 14, nome: "Piscina E", local: "Ponta Delgada - PT (Açores)", imagem: "piscinae.jpg" },
  { top: 75, left: 25.1, nome: "Piscina F", local: "Albufeira - PT", imagem: "piscinaf.jpg" },
  { top: 40, left: 26, nome: "Piscina 4", local: "Felgueiras - PT", imagem: "piscina4.jpg" },
  { top: 41, left: 23, nome: "Piscina 5", local: "Porto - PT", imagem: "piscina5.jpg" },
  { top: 68, left: 22, nome: "Piscina 6", local: "Sines - PT", imagem: "piscina6.jpg" },
  { top: 63.5, left: 22.5, nome: "Piscina 7", local: "Setúbal - PT", imagem: "piscina7.jpg" },
  { top: 49.6, left: 25, nome: "Piscina 8", local: "Condeixa-a-Nova - PT", imagem: "piscina8.jpg" },
  { top: 55, left: 26.8, nome: "Piscina 9", local: "Abrantes", imagem: "piscina9.jpg" },
  { top: 59, left: 24.3, nome: "Piscina 10", local: "Coruche - PT", imagem: "piscina10.jpg" },
  { top: 59, left: 22.3, nome: "Piscina 11", local: "Vila Franca de Xira - PT", imagem: "piscina11.jpg" },
  { top: 59.9, left: 21, nome: "Piscina 12", local: "Sto. António dos Cavaleiros - PT", imagem: "piscina12.jpg" },
  { top: 63.3, left: 21, nome: "Piscina 13", local: "Cova da Piedade - PT", imagem: "piscina13.jpg" },
  { top: 61.9, left: 19.2, nome: "Piscina 14", local: "Oeiras(jamor) - PT", imagem: "piscina14.jpg" },
  { top: 61.9, left: 20.9, nome: "Piscina 15", local: "Algés- PT", imagem: "piscina15.jpg" }
];

// CARTÕES, agora com retângulos flip 3D nos botões da direita
const conteudosCartao = {
  2: getCartaoModal('cmbcart-removebg-preview.png', 'mapacmb.png', []),
  3: getCartaoModal('anacart-removebg-preview.png', 'mapaanac.png', []),
  4: getCartaoModal('sfuapcart-removebg-preview.png', 'crcr-removebg-preview.png', pins4),
  5: getCartaoModal('cirlcart-removebg-preview.png', 'mapacirl.png', []),
  6: getCartaoModal('anycart-removebg-preview.png', 'mapaany.png', [])
};

// Função para gerar o cartão (aqui é onde aplicamos as mudanças flip na direita)
function getCartaoModal(imagemEsq, imagemMapa, pins = []) {
  return `
    <div class="cartao-conteudo-flex">
      <div class="cartao-esq">
        <img src="${imagemEsq}" alt="Cartão">
      </div>
      <div class="cartao-centro">
        <div class="mapa-centro-rel">
          <img src="${imagemMapa}" alt="Mapa Portugal">
          ${pins.map(pin =>
            `<div class="pin-mapa" style="top:${pin.top}%;left:${pin.left}%;" onclick="mostrarInfoPin(event, '${pin.nome}', '${pin.local}', '${pin.imagem}')"></div>`
          ).join('')}
          <div id="pin-popup"></div>
        </div>
      </div>
      <div class="cartao-dir">
        <!-- NOVO conteúdo Flip para cada botão -->
        <div class="retangulo-flip" tabindex="0">
          <div class="face frente">Medalhas</div>
          <div class="face verso">
            <div class="medalhas-lista">
              <div class="medalha-item">
                <img src="medalha1.png" alt="Medalha Ouro">
                <span>Medalha Ouro</span>
              </div>
              <div class="medalha-item">
                <img src="medalha2.png" alt="Medalha Prata">
                <span>Medalha Prata</span>
              </div>
              <div class="medalha-item">
                <img src="medalha3.png" alt="Medalha Bronze">
                <span>Medalha Bronze</span>
              </div>
            </div>
          </div>
        </div>
        <div class="retangulo-flip" tabindex="0">
          <div class="face frente">lesoes</div>
          <div class="face verso">
            <div class="texto-lesoes">
              Entorse do tornozelo<br>
              Fratura da clavícula<br>
              Rotura muscular
            </div>
          </div>
        </div>
        <div class="retangulo-flip" tabindex="0">
          <div class="face frente">eventos</div>
          <div class="face verso">
            <img src="evento1.jpg" alt="Evento 1" class="evento-img"/>
            <img src="evento2.jpg" alt="Evento 2" class="evento-img"/>
            <img src="evento3.jpg" alt="Evento 3" class="evento-img"/>
          </div>
        </div>
      </div>
    </div>
  `;
}

// -- Modal aberto --
function abrirCartao(idx) {
  const conteudo = conteudosCartao[idx] || "";
  const bg = document.createElement('div');
  bg.className = 'cartao-modal-bg';
  bg.setAttribute('tabindex', '-1');
  bg.onclick = function(e){
    if (e.target === bg) fecharCartao(bg);
  };
  const box = document.createElement('div');
  box.className = 'cartao-modal';
  box.tabIndex = 0;
  box.innerHTML = conteudo +
    `<button class="cartao-fechar" title="Fechar" aria-label="Fechar" onclick="fecharCartaoModal(event)">✕</button>`;
  bg.appendChild(box);
  document.body.appendChild(bg);

  requestAnimationFrame(() => {
    bg.classList.add('show');
    box.focus();

    // Para permitir flip em toque (móvel)
    bg.querySelectorAll('.retangulo-flip').forEach(function(ret){
      ret.addEventListener('touchstart', function(){
        // Remove flip de outros antes de ativar este
        bg.querySelectorAll('.retangulo-flip.tocado').forEach(r=>r.classList.remove('tocado'));
        this.classList.add('tocado');
      });
      ret.addEventListener('mouseleave', function(){ this.classList.remove('tocado'); });
    });
  });
}

// -- Fechar modal --
function fecharCartao(bg) {
  if (!bg) return;
  bg.classList.remove('show');
  bg.addEventListener('transitionend', function handler() {
    if (bg.parentNode) bg.parentNode.removeChild(bg);
    bg.removeEventListener('transitionend', handler);
  });
}
function fecharCartaoModal(e) {
  e.stopPropagation();
  const modalBg = e.target.closest('.cartao-modal-bg');
  fecharCartao(modalBg);
}

// Popup info dos pins: mostra nome, local, imagem
window.mostrarInfoPin = function (e, nome, local, imagem) {
  e.stopPropagation();
  const popup = document.querySelector("#pin-popup");
  popup.innerHTML = `<strong>${nome}</strong><br>${local}<br>${imagem ? `<img src="${imagem}" alt="${nome}">` : ''}`;
  popup.style.display = "block";
  // Posição relativa ao pin
  const parent = e.target.parentElement;
  const parentRect = parent.getBoundingClientRect();
  const pinRect = e.target.getBoundingClientRect();
  const y = pinRect.top - parentRect.top + 40;
  const x = pinRect.left - parentRect.left + 26;
  popup.style.top = y + "px";
  popup.style.left = x + "px";
  popup.style.pointerEvents = 'auto';
  // Esconde popup ao clicar fora
  setTimeout(() => {
    window.addEventListener('mousedown', esconderPopup, { once: true });
  }, 0);
}
function esconderPopup(e) {
  const popup = document.querySelector("#pin-popup");
  if (popup) popup.style.display = "none";
}

// -- Fade inicial --
window.addEventListener('load', () => {
  const screenFade = document.getElementById('screen-fade');
  if (!screenFade) return;
  setTimeout(() => {
    screenFade.style.opacity = '0';
  }, 100);
  screenFade.addEventListener('transitionend', () => {
    screenFade.remove();
  });
});
</script>
</body>
</html>

